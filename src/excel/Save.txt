Cotière du 13/09/2023

[
  [
    "CRIEE DE LORIENT",
    "VENTE DU ",
    null,
    45184,
    null,
    "PREVISIONS DES APPORTS DE LA PECHE COTIERE"
  ],
  [
    "vente cotiere 1",
    "CHALUTIER",
    null,
    null,
    null,
    "LIGNEUR ",
    null,
    null,
    null,
    "FILEYEUR",
    null,
    null,
    null,
    null,
    "CASIER"
  ],
  [
    "Nom bateau",
    "Tine \nvivante",
    "Araignée",
    "Lotte",
    "Sole",
    "Bar",
    "Lieu",
    "Merlu",
    "Daurade\n grise",
    "Merlan",
    "Rouget",
    "Maquereau",
    "Tourteau",
    "Homard",
    "Divers",
    "Total",
    "Commentaires et Poids"
  ],
  [
    "BELLADONE",
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    60,
    60,
    "gns-27-8"
  ],
  [
    "OCEANES",
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    135,
    135,
    "fpo-27-8  praires"
  ],
  [
    "REINE DES ANGES",
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    100,
    100,
    "lls-27-8   lignes "
  ],
  [
    "GAVRAISE",
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    100,
    100,
    "fpo-278"
  ],
  [
    "MAB EOLII",
    null,
    20,
    null,
    50,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    70,
    140,
    "gns-27-8"
  ],
  [
    "CASSIOPEE",
    null,
    null,
    null,
    null,
    5,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    15,
    20,
    "gns-27-8"
  ],
  [
    "DRAKKAR",
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    250,
    250,
    "gns-27-8   poulpes"
  ],
  [
    "GUEVELLEZED II",
    null,
    25,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    150,
    175,
    "gns-27-8"
  ],
  [
    "CHAUMIERE DE LA MER",
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    30,
    30,
    "fpo-27-8"
  ],
  [
    "ATOUT II",
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    120,
    120,
    "fpo-27-8"
  ],
  [
    "BELUGA",
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    45,
    45,
    "gns-27-8"
  ],
  [
    "CORALIE",
    null,
    null,
    null,
    10,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    2,
    12,
    "fpo-27-8"
  ],
  [
    "PENFRET",
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    100,
    100,
    "lls-27-8"
  ],
  [
    "IZEL VOR",
    null,
    null,
    null,
    50,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    50,
    "gns-27-8"
  ],
  [
    "ETOILE DES MERS",
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    30,
    30,
    "fpo-27-8"
  ],
  [
    "SPEEDY",
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    30,
    30,
    "gns-27-8"
  ],
  [
    "LUCIOLE",
    null,
    null,
    null,
    15,
    null,
    5,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    10,
    30,
    "gns-27-8"
  ],
  [
    "FLEUR DE RHUYS",
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    20,
    20,
    "gns-278"
  ],
  [
    "MARLEY 2",
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    50,
    50,
    "lls-27-8  lignes"
  ],
  [
    "PEN KALET",
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    30,
    30,
    "gns-27-8"
  ],
  [
    "PASSAGERE",
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    25,
    20,
    null,
    null,
    6,
    51,
    "fpo-27-8"
  ],
  [
    "MARY ME",
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    15,
    15,
    "gns-27-8"
  ],
  [
    "ORION",
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    "lls-27-8"
  ],
  [
    "CHIMERE",
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    100,
    100,
    "lls-27-8"
  ],
  [
    "ENEZ AVAL"
  ],
  [
    "ORCA",
    null,
    null,
    null,
    22,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    22,
    "gns-27-8"
  ],
  [
    "KIKKO",
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    50,
    50,
    "gns-27-8"
  ],
  [
    "ROUTE DU RHUM",
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    73,
    73,
    "fpo-27-8"
  ],
  [
    "CUPIDON GX",
    null,
    150,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    100,
    null,
    250,
    "fpo-27-8"
  ],
  [
    "JOLIANA",
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    10,
    10,
    "fpo-27-8"
  ],
  [
    "POPEYE",
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    100,
    100,
    "gns-27-8   vernies praires "
  ],
  [
    "TOTAL VENTE COTIERE 1 ",
    null,
    195,
    null,
    147,
    5,
    5,
    null,
    null,
    null,
    25,
    20,
    null,
    100,
    1701,
    2198
  ],
  [
    null,
    "Tine \nvivante",
    "Araignée",
    "Lotte",
    "Sole",
    "Bar",
    "Lieu",
    "Merlu",
    "Daurade\n grise",
    "Merlan",
    "Rouget",
    "Maquereau",
    "Tourteau",
    "Homard",
    "Divers",
    "Total"
  ],
  [
    "CRIEE DE LORIENT",
    "VENTE DU ",
    null,
    45184,
    null,
    "PREVISIONS DES APPORTS DE LA PECHE COTIERE"
  ],
  [
    "vente cotiere 2",
    "CHALUTIER",
    null,
    null,
    null,
    "LIGNEUR ",
    null,
    null,
    null,
    "FILEYEUR",
    null,
    null,
    null,
    null,
    "CASIER"
  ],
  [
    "Nom bateau",
    "Tine \nvivante",
    "Araignée",
    "Lotte",
    "Sole",
    "Bar",
    "Lieu",
    "Merlu",
    "Daurade\n grise",
    "Merlan",
    "Rouget",
    "Maquereau",
    "Tourteau",
    "Homard",
    "Divers",
    "Total",
    "Commentaires et Poids"
  ],
  [
    "HEBEILLAN II",
    150,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    200,
    350,
    "otb-27-8"
  ],
  [
    "HEYDENNA BREIZH",
    100,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    100,
    200,
    "otb-27-8"
  ],
  [
    "LINFERNAL",
    50,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    100,
    150,
    "otb-27-8"
  ],
  [
    "MANATHIA",
    300,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    500,
    800,
    "otb-27-8"
  ],
  [
    "OCEANIE",
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    700,
    700,
    "otb-27-8"
  ],
  [
    "DJAKEY",
    100,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    500,
    600,
    "otb-27-8"
  ],
  [
    "ETOILE POLAIRE",
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    600,
    600,
    "ps-27-8  sardines"
  ],
  [
    "MEN GWEN",
    40,
    50,
    250,
    null,
    null,
    null,
    150,
    null,
    null,
    null,
    null,
    null,
    null,
    250,
    740,
    "otb-27-8"
  ],
  [
    "MALOUROSIE",
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    20,
    20,
    "otb-27-8"
  ],
  [
    "JEAN BAPTISTE MAEL",
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    null,
    550,
    null,
    null,
    170,
    720,
    "otb-27-8  encornet 170"
  ],
  [
    "TOTAL VENTE COTIERE2",
    740,
    50,
    250,
    null,
    null,
    null,
    150,
    null,
    null,
    null,
    550,
    null,
    null,
    3140,
    4880
  ],
  [
    null,
    "Tine \nvivante",
    "Araignée",
    "Lotte",
    "Sole",
    "Bar",
    "Lieu",
    "Merlu",
    "Daurade\n grise",
    "Merlan",
    "Rouget",
    "Maquereau",
    "Tourteau",
    "Homard",
    "Divers",
    "Total"
  ],
  [
    "TOTAL",
    740,
    245,
    250,
    147,
    5,
    5,
    150,
    0,
    0,
    25,
    570,
    0,
    100,
    4841,
    7078
  ],
  [],
  [],
  [],
  [],
  [],
  [],
  [],
  [],
  []
]


//////////////////////////// Fichier excel.js

// Programme permettant de télécharger un fichier excel pour remplacer l'ancien. Ce fichier sera alors traiter pour en tirer l'ordre pour la vente à la criée

const fetch = require('node-fetch');
const fs = require('fs');
const XLSX = require('xlsx');
// Fonction pour télécharger le fichier Excel et le convertir en JSON
// Fonction pour télécharger le fichier Excel et le convertir en JSON
const downloadAndProcessExcel = async () => {
  try {
    
    const excelUrl =  'https://criee.keroman.fr/lor/data/data_cotiere_acheteur.xls';

    // Télécharge le fichier Excel
    const response = await fetch(excelUrl);
    if (!response.ok) {
      throw new Error('Erreur lors du téléchargement du fichier Excel');
    }

    const excelData = await response.arrayBuffer();

    // Convertit le fichier Excel en tableau JSON
    const workbook = XLSX.read(excelData, { type: 'array' });
    const sheetName = workbook.SheetNames[0];
    const sheet = workbook.Sheets[sheetName];
    const jsonData = XLSX.utils.sheet_to_json(sheet, { header: 1 });

    // Traitez les données comme vous le souhaitez
    console.log(jsonData);

    // Enregistrez les données dans un fichier JSON si nécessaire
    fs.writeFileSync('excel_data.json', JSON.stringify(jsonData, null, 2));
  } catch (error) {
    console.error('Une erreur est survenue :', error);
  }
};


downloadAndProcessExcel();

